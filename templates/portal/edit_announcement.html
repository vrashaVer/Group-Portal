<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.as_p }}

    <h3>Existing Photos:</h3>
    <div>
        {% if photos %}
            {% for photo in photos %}
                <div>
                    <img src="{{ photo.image.url }}" alt="Photo" style="max-width: 150px;">
                    <button type="button" onclick="deletePhoto('{{ photo.id }}')">Delete</button>
                </div>
            {% endfor %}
        {% else %}
            <p>No photos available.</p>
        {% endif %}
    </div>

    <h3>Existing Video:</h3>
    {% if video_url %}
        <p>Video URL: <a href="{{ video_url }}" target="_blank">{{ video_url }}</a></p>
        <input type="hidden" name="delete_video" id="delete_video_input" value="">
        <button type="button" onclick="deletePhoto('{{ photo.id }}')">Delete</button>
    {% else %}
        <p>No video available.</p>
    {% endif %}
    <input type="hidden" name="delete_photo_ids" id="delete_photo_ids" value="">
    <h3>Add New Media:</h3>
    {{ photo_form.as_p }}

    <button type="submit">Save Changes</button>

    <a href="{% url 'main'%}">Go back</a>
</form>

<script>
    function deleteVideo() {
        document.getElementById('delete_video_input').value = "1";
    }

    function deletePhoto(photoId) {
        // Додаємо ID фото до прихованого поля
        const inputField = document.getElementById('delete_photo_ids');
        const currentIds = inputField.value ? inputField.value.split(',') : [];
        if (!currentIds.includes(photoId)) {
            currentIds.push(photoId);
        }
        inputField.value = currentIds.join(',');

        // Ховаємо фото на сторінці
        const photoDiv = document.getElementById(`photo-${photoId}`);
        if (photoDiv) {
            photoDiv.style.display = 'none';
        }
    }

   
</script>
